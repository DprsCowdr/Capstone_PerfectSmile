<!-- DEBUG-VIEW START 6 APPPATH\Views\auth\login.php -->
<!-- DEBUG-VIEW START 3 APPPATH\Views\templates\header.php -->
<!DOCTYPE html>
<html lang="en">
<head>
<script  id="debugbar_loader" data-time="1758272658.255804" src="http://localhost:8080/?debugbar"></script><script  id="debugbar_dynamic_script"></script><style  id="debugbar_dynamic_style"></style><script class="kint-rich-script">"use strict";(()=>{function m(n){if(!(n instanceof Element))throw new Error("Invalid argument to dedupeElement()");let t=n.ownerDocument,e=E(n);for(let s of t.querySelectorAll(e))n!==s&&s.parentNode.removeChild(s)}function d(n){return n instanceof Element?n.ownerDocument.contains(n):!1}function E(n){if(!(n instanceof Element))throw new Error("Invalid argument to buildClassSelector()");return[n.nodeName,...n.classList].join(".")}function f(n){if(!(n instanceof Element))throw new Error("Invalid argument to selectText()");let t=n.ownerDocument,e=t.getSelection(),s=t.createRange();s.selectNodeContents(n),e.removeAllRanges(),e.addRange(s)}function I(n,t){let e;return function(...s){clearTimeout(e),e=setTimeout(function(){n(...s)},t)}}function x(n){if(!(n instanceof Element))throw new Error("Invalid argument to offsetTop()");return n.offsetTop+(n.offsetParent?x(n.offsetParent):0)}var u=class n{static#e=new Set;static toggleSearchBox(t,e){let s=t.querySelector(".kint-search"),i=t.parentNode;if(s)if(s.classList.toggle("kint-show",e)){if(s.focus(),s.select(),!n.#e.has(s)){let r=i.querySelectorAll("dl").length,o=200;r>1e4&&(o=700),s.addEventListener("keyup",I(n.#t.bind(null,s),o)),n.#e.add(s)}n.#t(s)}else i.classList.remove("kint-search-root")}static#t(t){let e=t.closest(".kint-parent")?.parentNode;if(e)if(t.classList.contains("kint-show")&&t.value.length){let s=e.dataset.lastSearch;if(e.classList.add("kint-search-root"),s!==t.value){e.dataset.lastSearch=t.value,e.classList.remove("kint-search-match");for(let i of e.querySelectorAll(".kint-search-match"))i.classList.remove("kint-search-match");n.#s(e,t.value.toUpperCase())}}else e.classList.remove("kint-search-root")}static#s(t,e){let s=t.cloneNode(!0);for(let c of s.querySelectorAll(".access-path"))c.remove();if(!s.textContent.toUpperCase().includes(e))return;t.classList.add("kint-search-match");let i=t.firstElementChild;for(;i&&i.tagName!=="DT";)i=i.nextElementSibling;if(!i)return;let r=a.getChildContainer(i);if(!r)return;let o,l;for(let c of r.children)c.tagName==="DL"?n.#s(c,e):c.tagName==="UL"&&(c.classList.contains("kint-tabs")?o=c.children:c.classList.contains("kint-tab-contents")&&(l=c.children));if(!(!o||o.length!==l?.length))for(let c=o.length;c--;){let k=!1,F=!1;o[c].textContent.toUpperCase().includes(e)&&(k=!0);let O=l[c].cloneNode(!0);for(let v of O.querySelectorAll(".access-path"))v.remove();if(O.textContent.toUpperCase().includes(e)&&(k=!0,F=!0),k&&o[c].classList.add("kint-search-match"),F)for(let v of l[c].children)v.tagName==="DL"&&n.#s(v,e)}}};var g=class{static sort(t,e){let s=t.dataset.kintTableSort,i=parseInt(s)===e?-1:1,r=t.tBodies[0];[...r.rows].sort(function(o,l){o=o.cells[e].textContent.trim().toLocaleLowerCase(),l=l.cells[e].textContent.trim().toLocaleLowerCase();let c=0;return!isNaN(o)&&!isNaN(l)?(o=parseFloat(o),l=parseFloat(l),c=o-l):isNaN(o)&&!isNaN(l)?c=1:isNaN(l)&&!isNaN(o)?c=-1:c=(""+o).localeCompare(""+l),c*i}).forEach(o=>r.appendChild(o)),i<0?t.dataset.kintTableSort=null:t.dataset.kintTableSort=e}};var a=class n{#e;#t;#s;constructor(t){if(!(t instanceof h))throw new Error("Invalid argument to Rich.constructor()");this.#e=t,this.#e.runOnInit(this.#i.bind(this));let e=new q(this,t);new b(this,t.window,e)}#i(){let t=this.#e.window.document;if(d(this.#t)||(this.#t=t.querySelector("style.kint-rich-style")),this.#t&&m(this.#t),t.querySelector(".kint-rich.kint-file")){this.setupFolder(t);let e=this.#s.querySelector("dd.kint-foldout"),s=Array.from(t.querySelectorAll(".kint-rich.kint-file"));for(let i of s)i.parentNode!==e&&e.appendChild(i);this.#s.classList.add("kint-show")}}addToFolder(t){let e=t.closest(".kint-rich");if(!e)throw new Error("Bad addToFolder");let s=this.#e.window.document;if(this.setupFolder(s),this.folder.contains(t))throw new Error("Bad addToFolder");let i=this.#s.querySelector("dd.kint-foldout"),r=t.closest(".kint-parent, .kint-rich"),o=Array.from(e.querySelectorAll(".kint-folder-trigger"));if(e===r||e.querySelectorAll(".kint-rich > dl").length===1){for(let l of o)l.remove();e.classList.add("kint-file"),i.insertBefore(e,i.firstChild)}else{let l=s.createElement("div");l.classList.add("kint-rich"),l.classList.add("kint-file"),l.appendChild(r.closest(".kint-rich > dl"));let c=e.lastElementChild;c.matches(".kint-rich > footer")&&l.appendChild(c.cloneNode(!0));for(let k of o)k.remove();i.insertBefore(l,i.firstChild)}n.toggle(this.#s.querySelector(".kint-parent"),!0)}setupFolder(t){if(this.#s)d(this.#s)||(this.#s=t.querySelector(".kint-rich.kint-folder"));else{let e=t.createElement("template");e.innerHTML='<div class="kint-rich kint-folder"><dl><dt class="kint-parent"><nav></nav>Kint</dt><dd class="kint-foldout"></dd></dl></div>',this.#s=e.content.firstChild,t.body.appendChild(this.#s)}}get folder(){return d(this.#s)||(this.#s=this.#e.window.document.querySelector(".kint-rich.kint-folder")),this.#s&&m(this.#s),this.#s}isFolderOpen(){let t=this.#s?.querySelector("dd.kint-foldout");if(t)return t.previousSibling.classList.contains("kint-show")}static getChildContainer(t){let e=t.nextElementSibling;for(;e&&!e.matches("dd");)e=e.nextElementSibling;return e}static toggle(t,e){let s=n.getChildContainer(t);s&&(e=t.classList.toggle("kint-show",e),n.#n(s,e))}static switchTab(t){t.parentNode.getElementsByClassName("kint-active-tab")[0].classList.remove("kint-active-tab"),t.classList.add("kint-active-tab");let e=t,s=0;for(;e=e.previousElementSibling;)s++;let i=t.parentNode.nextSibling.children;for(let r=i.length;r--;)r===s?(i[r].classList.add("kint-show"),n.#n(i[r],!0)):i[r].classList.remove("kint-show")}static toggleChildren(t,e){let s=n.getChildContainer(t);if(!s)return;e===void 0&&(e=t.classList.contains("kint-show"));let i=Array.from(s.getElementsByClassName("kint-parent"));for(let r of i)r.classList.toggle("kint-show",e)}static toggleAccessPath(t,e){let s=t.querySelector(".access-path");s?.classList.toggle("kint-show",e)&&f(s)}static#n(t,e){if(t.children.length===2&&t.lastElementChild.matches("ul.kint-tab-contents"))for(let s of t.lastElementChild.children)s.matches("li.kint-show")&&(t=s);if(t.children.length===1&&t.firstElementChild.matches("dl")){let s=t.firstElementChild.firstElementChild;s?.classList?.contains("kint-parent")&&n.toggle(s,e)}}},b=class{#e;#t;#s;#i=null;#n=null;#o=0;constructor(t,e,s){this.#e=t,this.#t=s,this.#s=e,this.#s.addEventListener("click",this.#a.bind(this),!0)}#r(){clearTimeout(this.#i),this.#i=setTimeout(this.#l.bind(this),250)}#l(){clearTimeout(this.#i),this.#i=null,this.#n=null,this.#o=0}#c(){let t=this.#n;if(!t.matches(".kint-parent > nav"))return;let e=t.parentNode;if(this.#o===1)a.toggleChildren(e),this.#t.onTreeChanged(),this.#r(),this.#o=2;else if(this.#o===2){this.#l();let s=e.classList.contains("kint-show"),i=this.#e.folder?.querySelector(".kint-parent"),r=Array.from(this.#s.document.getElementsByClassName("kint-parent"));for(let o of r)o!==i&&o.classList.toggle("kint-show",s);this.#t.onTreeChanged(),this.#t.scrollToFocus()}}#a(t){if(this.#o){this.#c();return}let e=t.target;if(!e.closest(".kint-rich"))return;if(e.tagName==="DFN"&&f(e),e.tagName==="TH"){t.ctrlKey||g.sort(e.closest("table"),e.cellIndex);return}if(e.tagName==="LI"&&e.parentNode.className==="kint-tabs"){if(e.className!=="kint-active-tab"){let i=e.closest("dl")?.querySelector(".kint-parent > nav")??e;a.switchTab(e),this.#t.onTreeChanged(),this.#t.setCursor(i)}return}let s=e.closest("dt");if(e.tagName==="NAV")e.parentNode.tagName==="FOOTER"?(this.#t.setCursor(e),e.parentNode.classList.toggle("kint-show")):s?.classList.contains("kint-parent")&&(a.toggle(s),this.#t.onTreeChanged(),this.#t.setCursor(e),this.#r(),this.#o=1,this.#n=e);else if(e.classList.contains("kint-access-path-trigger"))s&&a.toggleAccessPath(s);else if(e.classList.contains("kint-search-trigger"))s?.matches(".kint-rich > dl > dt.kint-parent")&&u.toggleSearchBox(s);else if(e.classList.contains("kint-folder-trigger")){if(s?.matches(".kint-rich > dl > dt.kint-parent"))this.#e.addToFolder(e),this.#t.onTreeChanged(),this.#t.setCursor(s.querySelector("nav")),this.#t.scrollToFocus();else if(e.parentNode.tagName==="FOOTER"){let i=e.closest(".kint-rich").querySelector(".kint-parent > nav, .kint-rich > footer > nav");this.#e.addToFolder(e),this.#t.onTreeChanged(),this.#t.setCursor(i),this.#t.scrollToFocus()}}else e.classList.contains("kint-search")||(e.tagName==="PRE"&&t.detail===3?f(e):e.closest(".kint-source")&&t.detail===3?f(e.closest(".kint-source")):e.classList.contains("access-path")?f(e):e.tagName!=="A"&&s?.classList.contains("kint-parent")&&(a.toggle(s),this.#t.onTreeChanged(),this.#t.setCursor(s.querySelector("nav"))))}},j=65,G=68,A=70,S=72,K=74,D=75,p=76,V=83,P=9,T=13,B=27,L=32,N=37,R=38,C=39,H=40,M=".kint-rich .kint-parent > nav, .kint-rich > footer > nav, .kint-rich .kint-tabs > li:not(.kint-active-tab)",q=class{#e=[];#t=0;#s=!1;#i;#n;constructor(t,e){this.#i=t,this.#n=e.window,this.#n.addEventListener("keydown",this.#c.bind(this),!0),e.runOnInit(this.onTreeChanged.bind(this))}scrollToFocus(){let t=this.#e[this.#t];if(!t)return;let e=this.#i.folder;if(t===e?.querySelector(".kint-parent > nav"))return;let s=x(t);if(this.#i.isFolderOpen()){let i=e.querySelector("dd.kint-foldout");i.scrollTo(0,s-i.clientHeight/2)}else this.#n.scrollTo(0,s-this.#n.innerHeight/2)}onTreeChanged(){let t=this.#e[this.#t];this.#e=[];let e=this.#i.folder,s=e?.querySelector(".kint-parent > nav"),i=this.#n.document;this.#i.isFolderOpen()&&(i=e,this.#e.push(s));let r=Array.from(i.querySelectorAll(M));for(let o of r)o.offsetParent!==null&&o!==s&&this.#e.push(o);if(s&&!this.#i.isFolderOpen()&&this.#e.push(s),this.#e.length===0){this.#s=!1,this.#r();return}t&&this.#e.indexOf(t)!==-1?this.#t=this.#e.indexOf(t):this.#r()}setCursor(t){if(this.#i.isFolderOpen()&&!this.#i.folder.contains(t)||!t.matches(M))return!1;let e=this.#e.indexOf(t);if(e===-1&&(this.onTreeChanged(),e=this.#e.indexOf(t)),e!==-1){if(e!==this.#t)return this.#t=e,this.#r(),!0;this.#e[e]?.classList.remove("kint-weak-focus")}else console.error("setCursor failed to find target in list",t),console.info("Please report this as a bug in Kint at https://github.com/kint-php/kint");return!1}#o(t){if(this.#e.length===0)return this.#t=0,null;for(this.#t+=t;this.#t<0;)this.#t+=this.#e.length;for(;this.#t>=this.#e.length;)this.#t-=this.#e.length;return this.#r(),this.#t}#r(){let t=this.#n.document.querySelector(".kint-focused");t&&(t.classList.remove("kint-focused"),t.classList.remove("kint-weak-focus")),this.#s&&this.#e[this.#t]?.classList.add("kint-focused")}#l(t){let e=t.closest(".kint-rich .kint-parent ~ dd")?.parentNode.querySelector(".kint-parent > nav");e&&(this.setCursor(e),this.scrollToFocus())}#c(t){if(this.#s&&t.keyCode===B&&t.target.matches(".kint-search")){t.target.blur(),this.#r();return}if(t.target!==this.#n.document.body||t.altKey||t.ctrlKey)return;if(t.keyCode===G){if(this.#s)this.#s=!1;else{if(this.#s=!0,this.onTreeChanged(),this.#e.length===0){this.#s=!1;return}this.scrollToFocus()}this.#r(),t.preventDefault();return}else if(t.keyCode===B){this.#s&&(this.#s=!1,this.#r(),t.preventDefault());return}else if(!this.#s)return;t.preventDefault(),d(this.#e[this.#t])||this.onTreeChanged();let e=this.#e[this.#t];if([P,R,D,H,K].includes(t.keyCode)){t.keyCode===P?this.#o(t.shiftKey?-1:1):t.keyCode===R||t.keyCode===D?this.#o(-1):(t.keyCode===H||t.keyCode===K)&&this.#o(1),this.scrollToFocus();return}if(e.tagName==="LI"&&[L,T,C,p,N,S].includes(t.keyCode)){t.keyCode===L||t.keyCode===T?(a.switchTab(e),this.onTreeChanged()):t.keyCode===C||t.keyCode===p?this.#o(1):(t.keyCode===N||t.keyCode===S)&&this.#o(-1),this.scrollToFocus();return}if(e.parentNode.tagName==="FOOTER"&&e.closest(".kint-rich")){if(t.keyCode===L||t.keyCode===T)e.parentNode.classList.toggle("kint-show");else if(t.keyCode===N||t.keyCode===S)if(e.parentNode.classList.contains("kint-show"))e.parentNode.classList.remove("kint-show");else{this.#l(e.closest(".kint-rich"));return}else if(t.keyCode===C||t.keyCode===p)e.parentNode.classList.add("kint-show");else if(t.keyCode===A&&!this.#i.isFolderOpen()&&e.matches(".kint-rich > footer > nav")){let i=e.closest(".kint-rich").querySelector(".kint-parent > nav, .kint-rich > footer > nav");this.#i.addToFolder(e),this.onTreeChanged(),this.setCursor(i),this.scrollToFocus()}return}let s=e.closest(".kint-parent");if(s){if(t.keyCode===j){a.toggleAccessPath(s);return}if(t.keyCode===A){!this.#i.isFolderOpen()&&s.matches(".kint-rich:not(.kint-folder) > dl > .kint-parent")&&(this.#i.addToFolder(e),this.onTreeChanged(),this.setCursor(e),this.scrollToFocus());return}if(t.keyCode===V){let i=s.closest(".kint-rich > dl")?.querySelector(".kint-search")?.closest(".kint-parent");if(i){e.classList.add("kint-weak-focus"),u.toggleSearchBox(i,!0);return}}if(t.keyCode===L||t.keyCode===T){a.toggle(s),this.onTreeChanged();return}if([C,p,N,S].includes(t.keyCode)){let i=s.classList.contains("kint-show");if(t.keyCode===C||t.keyCode===p){i&&a.toggleChildren(s,!0),a.toggle(s,!0),this.onTreeChanged();return}else if(i){a.toggleChildren(s,!1),a.toggle(s,!1),this.onTreeChanged();return}else{this.#l(s);return}}}}};var y=class{#e;#t;constructor(t){if(!(t instanceof h))throw new Error("Invalid argument to Plain.constructor()");this.#e=t.window,t.runOnInit(this.#s.bind(this))}#s(){d(this.#t)||(this.#t=this.#e.document.querySelector("style.kint-plain-style")),this.#t&&m(this.#t)}};var w=class{#e;constructor(t){if(!(t instanceof h))throw new Error("Invalid argument to Microtime.constructor()");this.#e=t.window,t.runOnInit(this.#t.bind(this))}#t(){let t={},e=this.#e.document.querySelectorAll("[data-kint-microtime-group]");for(let s of e){let i=s.querySelector(".kint-microtime-lap");if(!i)continue;let r=s.dataset.kintMicrotimeGroup,o=parseFloat(i.textContent),l=parseFloat(s.querySelector(".kint-microtime-avg").textContent);t[r]??={min:o,max:o,avg:l},t[r].min>o&&(t[r].min=o),t[r].max<o&&(t[r].max=o),t[r].avg=l}for(let s of e){let i=s.querySelector(".kint-microtime-lap");if(!i)continue;let r=parseFloat(i.textContent),o=t[s.dataset.kintMicrotimeGroup];if(s.querySelector(".kint-microtime-avg").textContent=o.avg,!(r===o.min&&r===o.max))if(s.classList.add("kint-microtime-js"),r>o.avg){let l=(r-o.avg)/(o.max-o.avg);i.style.background="hsl("+(40-40*l)+", 100%, 65%)"}else{let l=0;o.avg!==o.min&&(l=(o.avg-r)/(o.avg-o.min)),i.style.background="hsl("+(40+80*l)+", 100%, 65%)"}}}};var U=Symbol(),h=class n{static#e=null;#t;#s=[];#i=new Set;static init(t){return n.#e??=new n(t,U),n.#e.#n(),n.#e.runOnLoad(n.#r),n.#e}get window(){return this.#t}constructor(t,e){if(U!==e)throw new Error("Kint constructor is private. Use Kint.init()");if(!(t instanceof Window))throw new Error("Invalid argument to Kint.init()");this.#t=t,this.runOnInit(this.#o.bind(this)),new y(this),new a(this),new w(this)}runOnLoad(t){if(this.#t.document.readyState==="complete")try{t()}catch{}else this.#t.addEventListener("load",t)}runOnInit(t){this.#s.push(t)}#n(){this.#t.document.currentScript&&(this.#i.add(E(window.document.currentScript)),window.document.currentScript.remove())}#o(){for(let t of this.#i.keys())for(let e of this.#t.document.querySelectorAll(t))e.remove()}static#r(){for(let t of n.#e.#s)t()}};window.Kint||(window.Kint=h);window.Kint.init(window);})();
</script><style class="kint-rich-style">.kint-rich{--spacing: 4px;--nav-size: 15px;--backdrop-color: rgba(255, 255, 255, 0.9);--main-background: #e0eaef;--secondary-background: #c1d4df;--text-color: #1d1e1e;--variable-name-color: #1d1e1e;--variable-type-color: #0092db;--variable-type-color-hover: #5cb730;--border-color: #b6cedb;--border-color-hover: #0092db;--border: 1px solid var(--border-color);--foldout-max-size: calc(100vh - 100px);--foldout-zindex: 999999;--caret-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 150'><g stroke-width='2' fill='%23FFF'><path d='M1 1h28v28H1zm5 14h18m-9 9V6M1 61h28v28H1zm5 14h18' stroke='%23379'/><path d='M1 31h28v28H1zm5 14h18m-9 9V36M1 91h28v28H1zm5 14h18' stroke='%235A3'/><path d='M1 121h28v28H1zm5 5l18 18m-18 0l18-18' stroke='%23CCC'/></g></svg>");--ap-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><g stroke='%23000' fill='transparent'><path d='M2 8h3m3 3v3M8 2v3m3 3h3M3 8' stroke-width='2' stroke-linecap='round'/><circle stroke-width='1.5' r='4.5' cx='8' cy='8'/></g></svg>");--folder-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><path d='M2 2h4l2 2h6v9H2V2h2' stroke-width='2' stroke='%23000' fill='transparent' stroke-linejoin='round'/></svg>");--search-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><g stroke='%23000' fill='transparent'><path d='M2 14l3-3' stroke-linecap='round' stroke-width='3'/><circle stroke-width='2' r='5' cx='9' cy='7'/></g></svg>");font-size:13px;overflow-x:auto;white-space:nowrap;background:var(--backdrop-color);direction:ltr;contain:content}.kint-rich.kint-folder{position:fixed;bottom:0;left:0;right:0;z-index:var(--foldout-zindex);width:100%;margin:0;display:block}.kint-rich.kint-folder dd.kint-foldout{max-height:var(--foldout-max-size);padding-right:calc(var(--spacing)*2);overflow-y:scroll;display:none}.kint-rich.kint-folder dd.kint-foldout.kint-show{display:block}.kint-rich::selection{background:var(--border-color-hover);color:var(--text-color)}.kint-rich .kint-focused{box-shadow:0 0 3px 3px var(--variable-type-color-hover)}.kint-rich .kint-focused.kint-weak-focus{box-shadow:0 0 3px 1px color-mix(in srgb, var(--variable-type-color-hover) 50%, transparent)}.kint-rich,.kint-rich::before,.kint-rich::after,.kint-rich *,.kint-rich *::before,.kint-rich *::after{box-sizing:border-box;border-radius:0;color:var(--text-color);float:none !important;font-family:Consolas,Menlo,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New,monospace,serif;line-height:15px;margin:0;padding:0;text-align:left}.kint-rich{margin:calc(var(--spacing)*2) 0}.kint-rich dt,.kint-rich dl{width:auto}.kint-rich dt,.kint-rich div.access-path{background:var(--main-background);border:var(--border);color:var(--text-color);display:block;font-weight:bold;list-style:none outside none;overflow:auto;padding:var(--spacing)}.kint-rich dt:hover,.kint-rich div.access-path:hover{border-color:var(--border-color-hover)}.kint-rich>dl dl{padding:0 0 0 calc(var(--spacing)*3)}.kint-rich dt.kint-parent>nav,.kint-rich>footer>nav{background:var(--caret-image) no-repeat scroll 0 0/var(--nav-size) 75px rgba(0,0,0,0);cursor:pointer;display:inline-block;height:var(--nav-size);width:var(--nav-size);margin-right:3px;vertical-align:middle}.kint-rich dt.kint-parent:hover>nav,.kint-rich>footer>nav:hover{background-position:0 25%}.kint-rich dt.kint-parent.kint-show>nav,.kint-rich>footer.kint-show>nav{background-position:0 50%}.kint-rich dt.kint-parent.kint-show:hover>nav,.kint-rich>footer.kint-show>nav:hover{background-position:0 75%}.kint-rich dt.kint-parent.kint-locked>nav{background-position:0 100%}.kint-rich dt.kint-parent+dd{display:none;border-left:1px dashed var(--border-color);contain:strict}.kint-rich dt.kint-parent.kint-show+dd{display:block;contain:content}.kint-rich var,.kint-rich var a{color:var(--variable-type-color);font-style:normal}.kint-rich dt:hover var,.kint-rich dt:hover var a{color:var(--variable-type-color-hover)}.kint-rich dfn{font-style:normal;font-family:monospace;color:var(--variable-name-color)}.kint-rich pre{color:var(--text-color);margin:0 0 0 calc(var(--spacing)*3);padding:5px;overflow-y:hidden;border-top:0;border:var(--border);background:var(--main-background);display:block;word-break:normal}.kint-rich .kint-access-path-trigger,.kint-rich .kint-folder-trigger,.kint-rich .kint-search-trigger{background:color-mix(in srgb, var(--text-color) 80%, transparent);border-radius:3px;padding:2px;height:var(--nav-size);width:var(--nav-size);font-size:var(--nav-size);margin-left:5px;font-weight:bold;text-align:center;line-height:1;float:right !important;cursor:pointer;position:relative;overflow:hidden}.kint-rich .kint-access-path-trigger::before,.kint-rich .kint-folder-trigger::before,.kint-rich .kint-search-trigger::before{display:block;content:"";width:100%;height:100%;background:var(--main-background);mask:center/contain no-repeat alpha}.kint-rich .kint-access-path-trigger:hover,.kint-rich .kint-folder-trigger:hover,.kint-rich .kint-search-trigger:hover{background:var(--main-background)}.kint-rich .kint-access-path-trigger:hover::before,.kint-rich .kint-folder-trigger:hover::before,.kint-rich .kint-search-trigger:hover::before{background:var(--text-color)}.kint-rich .kint-access-path-trigger::before{mask-image:var(--ap-image)}.kint-rich .kint-folder-trigger::before{mask-image:var(--folder-image)}.kint-rich .kint-search-trigger::before{mask-image:var(--search-image)}.kint-rich input.kint-search{display:none;border:var(--border);border-top-width:0;border-bottom-width:0;padding:var(--spacing);float:right !important;margin:calc(var(--spacing)*-1) 0;color:var(--variable-name-color);background:var(--secondary-background);height:calc(var(--nav-size) + var(--spacing)*2);width:calc(var(--nav-size)*10);position:relative;z-index:100}.kint-rich input.kint-search.kint-show{display:block}.kint-rich .kint-search-root ul.kint-tabs>li:not(.kint-search-match){background:var(--secondary-background);filter:saturate(0);opacity:.5}.kint-rich .kint-search-root dl:not(.kint-search-match){opacity:.5}.kint-rich .kint-search-root dl:not(.kint-search-match)>dt{background:var(--main-background);filter:saturate(0)}.kint-rich .kint-search-root dl:not(.kint-search-match) dl,.kint-rich .kint-search-root dl:not(.kint-search-match) ul.kint-tabs>li:not(.kint-search-match){opacity:1}.kint-rich div.access-path{background:var(--secondary-background);display:none;margin-top:5px;padding:4px;white-space:pre}.kint-rich div.access-path.kint-show{display:block}.kint-rich footer{padding:0 3px 3px;font-size:9px;background:rgba(0,0,0,0)}.kint-rich footer>.kint-folder-trigger{background:rgba(0,0,0,0)}.kint-rich footer>.kint-folder-trigger::before{background:var(--text-color)}.kint-rich footer nav{height:10px;width:10px;background-size:10px 50px}.kint-rich footer>ol{display:none;margin-left:32px}.kint-rich footer.kint-show>ol{display:block}.kint-rich a{color:var(--text-color);text-shadow:none;text-decoration:underline}.kint-rich a:hover{color:var(--variable-name-color);border-bottom:1px dotted var(--variable-name-color)}.kint-rich ul{list-style:none;padding-left:calc(var(--spacing)*3)}.kint-rich ul:not(.kint-tabs) li{border-left:1px dashed var(--border-color)}.kint-rich ul:not(.kint-tabs) li>dl{border-left:none}.kint-rich ul.kint-tabs{margin:0 0 0 calc(var(--spacing)*3);padding-left:0;background:var(--main-background);border:var(--border);border-top:0}.kint-rich ul.kint-tabs>li{background:var(--secondary-background);border:var(--border);cursor:pointer;display:inline-block;height:calc(var(--spacing)*6);margin:calc(var(--spacing)/2);padding:0 calc(2px + var(--spacing)*2.5);vertical-align:top}.kint-rich ul.kint-tabs>li:hover,.kint-rich ul.kint-tabs>li.kint-active-tab:hover{border-color:var(--border-color-hover);color:var(--variable-type-color-hover)}.kint-rich ul.kint-tabs>li.kint-active-tab{background:var(--main-background);border-top:0;margin-top:-1px;height:27px;line-height:24px}.kint-rich ul.kint-tabs>li:not(.kint-active-tab){line-height:calc(var(--spacing)*5)}.kint-rich ul.kint-tabs li+li{margin-left:0}.kint-rich ul.kint-tab-contents>li{display:none;contain:strict}.kint-rich ul.kint-tab-contents>li.kint-show{display:block;contain:content}.kint-rich dt:hover+dd>ul>li.kint-active-tab{border-color:var(--border-color-hover);color:var(--variable-type-color-hover)}.kint-rich dt>.kint-color-preview{width:var(--nav-size);height:var(--nav-size);display:inline-block;vertical-align:middle;margin-left:10px;border:var(--border);background-color:#ccc;background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2 2"><path fill="%23FFF" d="M0 0h1v2h1V1H0z"/></svg>');background-size:min(20px,100%)}.kint-rich dt>.kint-color-preview:hover{border-color:var(--border-color-hover)}.kint-rich dt>.kint-color-preview>div{width:100%;height:100%}.kint-rich table{border-collapse:collapse;empty-cells:show;border-spacing:0}.kint-rich table *{font-size:12px}.kint-rich table dt{background:none;padding:calc(var(--spacing)/2)}.kint-rich table dt .kint-parent{min-width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.kint-rich table td,.kint-rich table th{border:var(--border);padding:calc(var(--spacing)/2);vertical-align:center}.kint-rich table th{cursor:alias}.kint-rich table td:first-child,.kint-rich table th{font-weight:bold;background:var(--secondary-background);color:var(--variable-name-color)}.kint-rich table td{background:var(--main-background);white-space:pre}.kint-rich table td>dl{padding:0}.kint-rich table pre{border-top:0;border-right:0}.kint-rich table thead th:first-child{background:none;border:0}.kint-rich table tr:hover>td{box-shadow:0 0 1px 0 var(--border-color-hover) inset}.kint-rich table tr:hover var{color:var(--variable-type-color-hover)}.kint-rich table ul.kint-tabs li.kint-active-tab{height:20px;line-height:17px}.kint-rich pre.kint-source{margin-left:-1px}.kint-rich pre.kint-source[data-kint-filename]:before{display:block;content:attr(data-kint-filename);margin-bottom:var(--spacing);padding-bottom:var(--spacing);border-bottom:1px solid var(--secondary-background)}.kint-rich pre.kint-source>div:before{display:inline-block;content:counter(kint-l);counter-increment:kint-l;border-right:1px solid var(--border-color-hover);padding-right:calc(var(--spacing)*2);margin-right:calc(var(--spacing)*2)}.kint-rich pre.kint-source>div.kint-highlight{background:var(--secondary-background)}.kint-rich .kint-microtime-js .kint-microtime-lap{text-shadow:-1px 0 var(--border-color-hover),0 1px var(--border-color-hover),1px 0 var(--border-color-hover),0 -1px var(--border-color-hover);color:var(--main-background);font-weight:bold}input.kint-note-input{width:100%}.kint-rich{--main-background: #f8f8f8;--secondary-background: #f8f8f8;--variable-type-color: #06f;--variable-type-color-hover: #f00;--border-color: #d7d7d7;--border-color-hover: #aaa;--alternative-background: #fff;--highlight-color: #cfc;--caret-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 150'><path d='M6 7h18l-9 15zm0 30h18l-9 15zm0 45h18l-9-15zm0 30h18l-9-15zm0 12l18 18m-18 0l18-18' fill='%23555'/><path d='M6 126l18 18m-18 0l18-18' stroke-width='2' stroke='%23555'/></svg>")}.kint-rich .kint-focused{box-shadow:0 0 3px 2px var(--variable-type-color-hover)}.kint-rich dt{font-weight:normal}.kint-rich dt.kint-parent{margin-top:4px}.kint-rich dl dl{margin-top:4px;padding-left:25px;border-left:none}.kint-rich>dl>dt{background:var(--secondary-background)}.kint-rich ul{margin:0;padding-left:0}.kint-rich ul:not(.kint-tabs)>li{border-left:0}.kint-rich ul.kint-tabs{background:var(--secondary-background);border:var(--border);border-width:0 1px 1px 1px;padding:4px 0 0 12px;margin-left:-1px;margin-top:-1px}.kint-rich ul.kint-tabs li,.kint-rich ul.kint-tabs li+li{margin:0 0 0 4px}.kint-rich ul.kint-tabs li{border-bottom-width:0;height:calc(var(--spacing)*6 + 1px)}.kint-rich ul.kint-tabs li:first-child{margin-left:0}.kint-rich ul.kint-tabs li.kint-active-tab{border-top:var(--border);background:var(--alternative-background);font-weight:bold;padding-top:0;border-bottom:1px solid var(--alternative-background) !important;margin-bottom:-1px}.kint-rich ul.kint-tabs li.kint-active-tab:hover{border-bottom:1px solid var(--alternative-background)}.kint-rich ul>li>pre{border:var(--border)}.kint-rich dt:hover+dd>ul{border-color:var(--border-color-hover)}.kint-rich pre{background:var(--alternative-background);margin-top:4px;margin-left:25px}.kint-rich .kint-source{margin-left:-1px}.kint-rich .kint-source .kint-highlight{background:var(--highlight-color)}.kint-rich .kint-parent.kint-show>.kint-search{border-bottom-width:1px}.kint-rich table td{background:var(--alternative-background)}.kint-rich table td>dl{padding:0;margin:0}.kint-rich table td>dl>dt.kint-parent{margin:0}.kint-rich table td:first-child,.kint-rich table td,.kint-rich table th{padding:2px 4px}.kint-rich table dd,.kint-rich table dt{background:var(--alternative-background)}.kint-rich table tr:hover>td{box-shadow:none;background:var(--highlight-color)}
</style>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Perfect Smile</title>
    <!-- Custom fonts for this template-->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
    <!-- Tailwind CSS -->
    <link rel="stylesheet" href="http://localhost:8080/css/style.css">
    <!-- Admin Panel Styles -->
    <link rel="stylesheet" href="http://localhost:8080/css/admin.css">
    <!-- Custom Styles -->
    <link rel="stylesheet" href="http://localhost:8080/css/custom.css">
    <style>
        body, html {
            margin: 0 !important;
            padding: 0 !important;
            background: #ffffff !important;
            color: #1e293b !important;
        }
    </style>
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- DEBUG-VIEW START 1 APPPATH\Views\templates\alert_helper.php -->
<style>
/* Inline invoice alert styles + fade animation (shared) */
.invoice-alert-container { position: fixed; top: 1.5rem; right: 1.5rem; z-index: 60; max-width: 20rem; }
.invoice-alert { margin-bottom: .5rem; padding: .75rem 1rem; border-radius: .5rem; box-shadow: 0 6px 18px rgba(15,23,42,0.08); display:flex; align-items:flex-start; gap:.5rem; opacity:0; transform: translateY(-8px); transition: opacity .28s ease, transform .28s ease; }
.invoice-alert.show { opacity:1; transform: translateY(0); }
.invoice-alert.hide { opacity:0; transform: translateY(-8px); }
.invoice-alert .invoice-msg { flex:1; font-size: .875rem; }
.invoice-alert .invoice-close { background: transparent; border: none; font-size: 1.25rem; line-height: 1; cursor: pointer; opacity: .85; }
.invoice-alert.info { background: #eff6ff; border: 1px solid #bfdbfe; color: #1e3a8a; }
.invoice-alert.success { background: #ecfdf5; border: 1px solid #bbf7d0; color: #065f46; }
.invoice-alert.warning { background: #fffbeb; border: 1px solid #fde68a; color: #92400e; }
.invoice-alert.error { background: #fff1f2; border: 1px solid #fecaca; color: #9f1239; }
</style>

<script>
// Shared inline alert helper with fade-in/out animation
if (typeof window.showInvoiceAlert !== 'function') {
    window.showInvoiceAlert = function(message, type = 'info', timeout = 5000) {
        var containerId = 'invoice-alert-container';
        var container = document.getElementById(containerId);

        if (!container) {
            container = document.createElement('div');
            container.id = containerId;
            container.className = 'invoice-alert-container';
            document.body.appendChild(container);
        }

        var el = document.createElement('div');
        el.className = 'invoice-alert ' + (type || 'info');

        var msg = document.createElement('div');
        msg.className = 'invoice-msg';
        msg.textContent = String(message);

        var btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'invoice-close';
        btn.setAttribute('aria-label', 'Dismiss');
        btn.innerHTML = '&times;';

        el.appendChild(msg);
        el.appendChild(btn);

        var removeEl = function() {
            el.classList.remove('show');
            el.classList.add('hide');
            el.addEventListener('transitionend', function te() {
                if (el.parentNode) el.parentNode.removeChild(el);
                el.removeEventListener('transitionend', te);
            });
        };

        btn.addEventListener('click', function () { removeEl(); });

        container.appendChild(el);
        requestAnimationFrame(function() { el.classList.add('show'); });

        if (timeout > 0) {
            setTimeout(function () { removeEl(); }, timeout);
        }
    };
}
</script>

<!-- DEBUG-VIEW ENDED 1 APPPATH\Views\templates\alert_helper.php -->
    <!-- DEBUG-VIEW START 2 APPPATH\Views\templates\prompt_helper.php -->
<style>
/* Simple prompt modal helper */
#psm-prompt-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.45); display: none; align-items: center; justify-content: center; z-index: 70; }
#psm-prompt { background: #fff; border-radius: 8px; padding: 16px; width: 100%; max-width: 480px; box-shadow: 0 10px 30px rgba(2,6,23,0.15); }
#psm-prompt .psm-title { font-weight: 600; margin-bottom: 8px; }
#psm-prompt .psm-input { width: 100%; padding: 8px 10px; border: 1px solid #e5e7eb; border-radius: 6px; margin-bottom: 10px; }
#psm-prompt .psm-actions { display:flex; gap:8px; justify-content: flex-end; }
#psm-prompt .psm-btn { padding: 8px 12px; border-radius: 6px; cursor:pointer; border: none; }
#psm-prompt .psm-btn.cancel { background: #f3f4f6; color:#111827 }
#psm-prompt .psm-btn.ok { background: #2563eb; color: white }
</style>

<div id="psm-prompt-overlay" role="dialog" aria-modal="true" aria-hidden="true">
    <div id="psm-prompt">
        <div class="psm-title" id="psm-prompt-title"></div>
        <input id="psm-prompt-input" class="psm-input" type="text" />
        <div class="psm-actions">
            <button id="psm-cancel" class="psm-btn cancel">Cancel</button>
            <button id="psm-ok" class="psm-btn ok">OK</button>
        </div>
    </div>
</div>

<script>
// Promise-based prompt modal
if (typeof window.showPrompt !== 'function') {
    window.showPrompt = function(message, placeholder = '', defaultValue = '') {
        return new Promise((resolve) => {
            var overlay = document.getElementById('psm-prompt-overlay');
            var title = document.getElementById('psm-prompt-title');
            var input = document.getElementById('psm-prompt-input');
            var btnOk = document.getElementById('psm-ok');
            var btnCancel = document.getElementById('psm-cancel');

            title.textContent = message || '';
            input.value = defaultValue || '';
            input.placeholder = placeholder || '';

            function cleanup() {
                overlay.style.display = 'none';
                overlay.setAttribute('aria-hidden', 'true');
                btnOk.removeEventListener('click', onOk);
                btnCancel.removeEventListener('click', onCancel);
                input.removeEventListener('keydown', onKey);
            }

            function onOk() {
                var val = input.value;
                cleanup();
                resolve(val);
            }

            function onCancel() {
                cleanup();
                resolve(null);
            }

            function onKey(e) {
                if (e.key === 'Enter') onOk();
                if (e.key === 'Escape') onCancel();
            }

            btnOk.addEventListener('click', onOk);
            btnCancel.addEventListener('click', onCancel);
            input.addEventListener('keydown', onKey);

            overlay.style.display = 'flex';
            overlay.setAttribute('aria-hidden', 'false');
            setTimeout(() => input.focus(), 50);
        });
    };
}
</script>

<!-- DEBUG-VIEW ENDED 2 APPPATH\Views\templates\prompt_helper.php -->
    <script>
        // Global base URL bootstrap to prevent client scripts from concatenating 'undefined'
        // Do not overwrite if already set by a page-specific script.
        try {
            if (typeof window !== 'undefined') {
                window.baseUrl = window.baseUrl || 'http://localhost:8080';
            }
        } catch (e) {
            // noop
            console.error('Failed to set global baseUrl', e);
        }
    </script>
</head>
    <body style="background: #ffffff; color: #1e293b;"> 
    <!-- Global snackbar (Tailwind styled) -->
    <div id="globalSnackbar" class="fixed right-5 bottom-5 z-50 hidden transform transition-all duration-200" aria-live="polite">
           <!-- Theme: soft-primary with subtle shadow and slide/opacity transitions -->
           <div id="globalSnackbarInner" class="max-w-xl mr-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-4 py-2 rounded-lg shadow-xl opacity-0 translate-y-2 transform transition-all duration-250 ease-out pointer-events-auto"></div>
    </div>

<!-- DEBUG-VIEW ENDED 3 APPPATH\Views\templates\header.php -->

<div class="flex min-h-screen bg-[#F5ECFE]">
    <div class="flex flex-col justify-center items-center flex-1 px-8 py-8">
        <div class="text-4xl font-bold mb-10 text-gray-800 font-nunito">Perfect Smile :)</div>
        <form class="w-full max-w-md flex flex-col gap-6 bg-white/0" method="POST" action="http://localhost:8080/auth/login">
            <div>
                <label for="email" class="font-semibold text-gray-800 mb-2 block">Email address</label>
                <input type="email" id="email" name="email" placeholder="Enter your email" required
                    class="border-2 border-[#c7aefc] rounded-lg px-4 py-3 text-base bg-[#f9f6ff] text-gray-800 outline-none transition-colors duration-200 w-full focus:border-[#a47be5] mb-1">
            </div>
            <div>
                <div class="flex justify-between items-center mb-1">
                    <label for="password" class="font-semibold text-gray-800 mb-0">Password</label>
                    <a href="#" class="text-sm text-indigo-500 font-medium hover:underline ml-4">forgot password</a>
                </div>
                <input type="password" id="password" name="password" placeholder="Enter your password" required
                    class="border-2 border-[#c7aefc] rounded-lg px-4 py-3 text-base bg-[#f9f6ff] text-gray-800 outline-none transition-colors duration-200 w-full focus:border-[#a47be5] mb-1">
            </div>
            <div class="flex items-center gap-2 mb-1">
                <input type="checkbox" id="remember" name="remember" class="accent-[#c7aefc]">
                <label for="remember" class="mb-0">Remember Me</label>
            </div>
            <button type="submit"
                class="bg-[#c7aefc] hover:bg-[#a47be5] text-white rounded-lg py-3 text-lg font-bold w-full mt-2 transition-colors duration-200">Login</button>
        </form>
        <div class="register-link text-center mt-4 text-gray-800">
            Don't have an account? <a href="http://localhost:8080/auth/register" class="text-indigo-500 font-semibold hover:underline">Register here</a>
        </div>
    </div>
    <div class="flex-1 hidden lg:flex items-center justify-center min-h-screen bg-white rounded-tl-[40px] rounded-bl-[40px]"
        style="background-image: url('http://localhost:8080/img/bg.jpg'); background-position: center; background-size: cover;">
        <!-- Image goes here later -->
    </div>
</div>

<!-- DEBUG-VIEW START 5 APPPATH\Views\templates\footer.php -->
    <!-- Bootstrap JS bundle (includes Popper) needed by sb-admin script -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom scripts for all pages-->
    <script src="http://localhost:8080/js/sb-admin-2.min.js"></script>
    <script>
        // Delegated handler: show confirm dialog for elements (forms or links) that opt-in via data-confirm
        (function(){
            function handleAction(e) {
                var el = e.target;
                // Walk up to nearest element that has data-confirm
                while (el && el !== document) {
                    if (el.dataset && el.dataset.confirm) break;
                    el = el.parentNode;
                }
                if (!el || el === document) return;
                var message = el.dataset.confirm || 'Are you sure?';

                // If it's a link, confirm before navigating
                if (el.tagName === 'A') {
                    if (!confirm(message)) {
                        e.preventDefault();
                    }
                    return;
                }

                // If inside a form/button structure, let the form submission be intercepted
                // Find nearest form
                var form = el.tagName === 'FORM' ? el : el.closest('form');
                if (form) {
                    if (!confirm(message)) {
                        e.preventDefault();
                        return;
                    }
                    // allow submission
                }
            }

            // Attach to document for delegation (clicks and submits)
            document.addEventListener('click', function(e){
                try { handleAction(e); } catch(err) { /* noop */ }
            }, true);

            // For forms that are submitted programmatically or via Enter key, handle submit event as well
            document.addEventListener('submit', function(e){
                try {
                    var form = e.target;
                    if (!form) return;
                    // If the form itself has data-confirm, prompt
                    if (form.dataset && form.dataset.confirm) {
                        if (!confirm(form.dataset.confirm)) {
                            e.preventDefault();
                        }
                    }
                } catch(err) { /* noop */ }
            }, true);
        })();
    </script>
    <script src="http://localhost:8080/js/availability-badges.js"></script>
<!-- DEBUG-VIEW START 4 APPPATH\Views\partials\message_modal.php -->
<div id="globalMessageModalRoot" class="hidden fixed inset-0 z-[12000] flex items-center justify-center" aria-hidden="true">
  <div class="modal-overlay absolute inset-0 bg-black/30 backdrop-blur-sm" data-role="overlay"></div>

  <div class="modal-stack w-full max-w-3xl mx-4">
  <!-- single panel used to render the active stack item -->
  <div class="modal-panel bg-white rounded-lg shadow-xl border-l-4 border-purple-400 overflow-hidden transform transition duration-200 opacity-0 translate-y-2" role="dialog" aria-modal="true" aria-labelledby="globalModalTitle" aria-describedby="globalModalDesc" tabindex="-1">
      <div class="p-4">
        <div class="flex items-start justify-between gap-4">
          <div class="flex-1">
            <h3 id="globalModalTitle" class="text-lg font-semibold text-purple-700">Title</h3>
            <div id="globalModalDesc" class="mt-2 text-sm text-slate-700">Message</div>
          </div>
          <button type="button" class="modal-close text-slate-500 hover:text-slate-800 ml-4" aria-label="Close">&times;</button>
        </div>
        <div id="globalModalActions" class="mt-4 text-right">
          <button type="button" class="modal-ok px-4 py-2 bg-purple-600 text-white rounded">OK</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- The partial provides a DOM node the JS can use: window._modalRoot -->
<script>
  // Expose modal root for script usage (script will be placed where partial is included)
  (function(){
    try {
      // Avoid double-initialization
      if (window._modalInited) return;
      window._modalInited = true;
      window._modalRoot = document.getElementById('globalMessageModalRoot');

      // modal stack and helpers
      window._modalStack = window._modalStack || [];

      function renderTop() {
        const root = window._modalRoot;
        if (!root) return;
        const panel = root.querySelector('.modal-panel');
        const titleEl = root.querySelector('#globalModalTitle');
        const descEl = root.querySelector('#globalModalDesc');
        const actionsEl = root.querySelector('#globalModalActions');

        const top = window._modalStack.length ? window._modalStack[window._modalStack.length-1] : null;
        if (!top) {
          // When hiding the modal, ensure no focused element remains inside the modal root
          try {
            if (document.activeElement && root.contains(document.activeElement)) {
              // Try to restore focus to previously focused element if available
              const last = window._lastModalFocus && window._lastModalFocus instanceof HTMLElement ? window._lastModalFocus : null;
              if (last && typeof last.focus === 'function') {
                last.focus();
              } else {
                // fallback: blur the active element and move focus to body
                try { document.activeElement.blur(); } catch(e){}
                try { document.body.focus(); } catch(e){}
              }
            }
          } catch(e){}

          // Use inert to hide and prevent focus; remove aria-hidden to avoid hiding a focused descendant
          try {
            root.inert = true;
          } catch(e) {
            // fallback for browsers without inert support: add aria-hidden
            root.setAttribute('aria-hidden', 'true');
          }
          root.classList.add('hidden');
          panel.classList.remove('opacity-100');
          panel.classList.add('opacity-0','translate-y-2');
          return;
        }

  // Showing modal: remove inert so assistive tech can access it
  try { root.inert = false; } catch(e) { root.removeAttribute('aria-hidden'); }
        root.classList.remove('hidden');
        titleEl.textContent = top.title || 'Message';
        // allow HTML content (string or DOM node) when provided
        if (top.html) {
          // clear existing
          descEl.innerHTML = '';
          if (typeof top.html === 'string') {
            descEl.innerHTML = top.html;
          } else if (top.html instanceof Node) {
            descEl.appendChild(top.html);
          } else {
            // fallback to message
            descEl.textContent = top.message || '';
          }
        } else {
          // plain text fallback
          descEl.textContent = top.message || '';
        }

        // theme classes
        panel.classList.remove('border-green-500','border-red-500','border-yellow-400','border-blue-500');
        panel.classList.add('border-l-4','border-purple-400');
        titleEl.classList.remove('text-green-700','text-red-700','text-yellow-700','text-blue-700');
        titleEl.classList.add('text-purple-700');

        // Populate action buttons unless caller asked to suppress actions
        actionsEl.innerHTML = '';
        if (!top.suppressActions) {
          if (top.type === 'confirm') {
          const yes = document.createElement('button');
          yes.className = 'px-4 py-2 bg-purple-600 text-white rounded mr-2';
          yes.textContent = top.yesText || 'Yes';
          yes.onclick = () => { try { top.onYes && top.onYes(); } catch(e){}; popModal(); };
          const no = document.createElement('button');
          no.className = 'px-4 py-2 bg-gray-200 text-gray-700 rounded';
          no.textContent = top.noText || 'No';
          no.onclick = () => { try { top.onNo && top.onNo(); } catch(e){}; popModal(); };
          actionsEl.appendChild(no);
          actionsEl.appendChild(yes);
          } else {
          const ok = document.createElement('button');
          ok.className = 'modal-ok px-4 py-2 bg-purple-600 text-white rounded';
          ok.textContent = top.okText || 'OK';
          ok.onclick = () => { try { top.onOk && top.onOk(); } catch(e){}; popModal(); };
          actionsEl.appendChild(ok);
          }
        }

        panel.classList.remove('opacity-0','translate-y-2');
        panel.classList.add('opacity-100');
        panel.style.transition = 'opacity 220ms ease, transform 220ms ease';
        panel.style.transform = 'translateY(0)';

        // remember what element had focus before opening the modal so we can restore later
        try { window._lastModalFocus = document.activeElement instanceof HTMLElement ? document.activeElement : null; } catch(e) { window._lastModalFocus = null; }
        // move focus into the modal for keyboard/AT users
        try {
          const closeBtn = panel.querySelector('.modal-close');
          if (closeBtn && typeof closeBtn.focus === 'function') closeBtn.focus();
          else panel.focus();
        } catch(e){}
      }

      function pushModal(opts) { 
        try { if (console && console.debug) console.debug('[modal] push', opts); } catch(e){}
        // record what had focus before opening
        try { opts = opts || {}; opts._prevActive = document.activeElement instanceof HTMLElement ? document.activeElement : null; } catch(e) { opts = opts || {}; opts._prevActive = null; }
        window._modalStack.push(opts); renderTop(); 
      }
      function popModal() { 
        try { if (console && console.debug) console.debug('[modal] pop'); } catch(e){}
        const popped = window._modalStack.pop();
        renderTop(); 
        // After popping, try to restore focus to previous element (if any)
        try {
          const prev = popped && popped._prevActive && popped._prevActive instanceof HTMLElement ? popped._prevActive : (window._lastModalFocus && window._lastModalFocus instanceof HTMLElement ? window._lastModalFocus : null);
          if (prev && typeof prev.focus === 'function') prev.focus();
          else {
            // make body briefly focusable as a fallback
            const body = document.body;
            const prevTab = body.getAttribute('tabindex');
            body.setAttribute('tabindex', '-1');
            try { body.focus(); } catch(e){}
            if (prevTab === null) body.removeAttribute('tabindex'); else body.setAttribute('tabindex', prevTab);
          }
        } catch(e){}
      }

      // expose globals
      window.pushModal = window.pushModal || pushModal;
      window.popModal = window.popModal || popModal;
      window.showMessageModal = window.showMessageModal || function(message, title = 'Message', type = 'info') { pushModal({ message, title, type }); };
      window.showConfirmModal = window.showConfirmModal || function(message, title = 'Confirm', onYes, onNo, yesText='Yes', noText='No') { pushModal({ type: 'confirm', message, title, onYes, onNo, yesText, noText }); };

      // wire overlay and close button
      document.addEventListener('click', function(e){
        const root = window._modalRoot; if (!root) return;
        if (e.target.matches('.modal-close') || e.target.matches('.modal-overlay')) { popModal(); }
      });
      document.addEventListener('keydown', function(e){ if (e.key === 'Escape') popModal(); });

      // initial render
      renderTop();
    } catch(e) { console.error('modal partial init failed', e); }
  })();
</script>

<!-- DEBUG-VIEW ENDED 4 APPPATH\Views\partials\message_modal.php -->
<script>
    // Global reschedule helper: available on any page that renders the footer.
    (function(){
        if (window.reschedulePatient) return; // don't overwrite if already present
        window.reschedulePatient = async function(appointmentId){
            try {
                const resp = await fetch('/queue/reschedule', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'X-Requested-With': 'XMLHttpRequest' },
                    body: JSON.stringify({ appointmentId })
                });
                const data = await resp.json();
                if (!data.success) {
                    // Prefer modal message if available
                    if (window.showMessageModal) return window.showMessageModal(data.message || 'No suggestions', 'Reschedule', 'info');
                    return alert(data.message || 'No suggestions');
                }

                const suggestions = data.suggestions || [];
                // Helper: format HH:MM (24h) or full datetime -> h:MM AM/PM
                function prettyTime(hm) {
                    if (!hm) return hm;
                    if (typeof hm !== 'string') return hm;
                    let timePart = hm;
                    if (hm.indexOf(' ') !== -1) timePart = hm.split(' ')[1];
                    const parts = timePart.split(':');
                    if (parts.length < 2) return hm;
                    let hh = parseInt(parts[0], 10);
                    const mm = parts[1];
                    const ampm = hh >= 12 ? 'PM' : 'AM';
                    hh = hh % 12; if (hh === 0) hh = 12;
                    return hh + ':' + mm + ' ' + ampm;
                }
                // Build content DOM
                const content = document.createElement('div');
                content.className = 'p-6';
                const title = document.createElement('h3');
                title.className = 'text-lg font-semibold text-gray-900 mb-3';
                title.textContent = 'You are about to reschedule this appointment';
                content.appendChild(title);

                // System prompt (show old schedule) — display in 12-hour format and include the date when available
                const systemPrompt = document.createElement('div');
                systemPrompt.className = 'text-sm text-gray-700 mb-3';
                try {
                    let datePart = '';
                    // Attempt to extract YYYY-MM-DD from old_time or first suggestion
                    if (data.old_time && typeof data.old_time === 'string' && data.old_time.indexOf(' ') !== -1) {
                        datePart = data.old_time.split(' ')[0];
                    } else if (suggestions && suggestions.length && typeof suggestions[0] === 'string' && suggestions[0].indexOf(' ') !== -1) {
                        datePart = suggestions[0].split(' ')[0];
                    }
                    let prettyDate = '';
                    if (datePart) {
                        try {
                            // Format to a human-friendly date when possible
                            const dt = new Date(datePart);
                            if (!isNaN(dt.getTime())) {
                                prettyDate = dt.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });
                            }
                        } catch (e) { /* noop */ }
                    }
                    const pretty = prettyTime(data.old_time) || 'unknown';
                    systemPrompt.textContent = 'The old schedule is ' + pretty + (prettyDate ? (' on ' + prettyDate) : '') + '. Please select a new date and time.';
                } catch (e) {
                    systemPrompt.textContent = 'The old schedule is ' + (prettyTime(data.old_time) || 'unknown') + '. Please select a new date and time.';
                }
                content.appendChild(systemPrompt);
                content.appendChild(title);

                const list = document.createElement('div');
                list.className = 'space-y-2';
                    content.appendChild(list);

                    // Confirmation helper line
                        const confirmHelper = document.createElement('div');
                        confirmHelper.className = 'mt-3 text-sm text-gray-600';
                        confirmHelper.textContent = 'Confirming will remove this patient from the waiting queue and set their appointment to scheduled at the chosen time.';
                    content.appendChild(confirmHelper);
                    suggestions.forEach((s, idx) => {
                    const label = document.createElement('label');
                    label.className = 'flex items-center space-x-3 p-2 border rounded hover:bg-gray-50 cursor-pointer';
                    const radio = document.createElement('input');
                    radio.type = 'radio';
                    radio.name = 'reschedule_choice_' + appointmentId;
                    radio.value = s;
                    if (idx === 0) radio.checked = true;
                    const txt = document.createElement('span');
                    txt.className = 'text-gray-700';
                    txt.textContent = prettyTime(s);
                    label.appendChild(radio);
                    label.appendChild(txt);
                    list.appendChild(label);
                        // update helper when suggestion selected
                        radio.addEventListener('change', () => { if (radio.checked) confirmHelper.textContent = 'Confirming will remove this patient from the waiting queue and set their appointment to scheduled at ' + prettyTime(s) + '.'; });
                });
                content.appendChild(list);

                // Prefill the date input with the appointment's current date when available
                try {
                    // data.old_time may be a full datetime like 'YYYY-MM-DD HH:MM:SS' or an appointment_datetime
                    if (typeof dateInput !== 'undefined') {
                        let prefillDate = null;
                        if (data.old_time && typeof data.old_time === 'string' && data.old_time.indexOf(' ') !== -1) {
                            prefillDate = data.old_time.split(' ')[0];
                        } else if (suggestions && suggestions.length && suggestions[0] && suggestions[0].indexOf(' ') !== -1) {
                            prefillDate = suggestions[0].split(' ')[0];
                        }
                        if (prefillDate) dateInput.value = prefillDate;
                    }
                } catch (e) { /* noop */ }

                const btnRow = document.createElement('div');
                btnRow.className = 'mt-4 flex justify-end space-x-2';

                const cancelBtn = document.createElement('button');
                cancelBtn.className = 'px-4 py-2 rounded bg-gray-100 text-gray-700';
                cancelBtn.textContent = 'Cancel';
                cancelBtn.addEventListener('click', () => { if (window.popModal) window.popModal(); });

                // Choose another: show inline date + time inputs as a labeled radio option
                const chooseAnotherWrapper = document.createElement('label');
                chooseAnotherWrapper.className = 'flex items-center space-x-3 p-2 border rounded hover:bg-gray-50 cursor-pointer';
                const chooseRadio = document.createElement('input');
                chooseRadio.type = 'radio';
                chooseRadio.name = 'reschedule_choice_' + appointmentId;
                chooseRadio.value = '';
                // Date input (prefilled later when modal opens)
                const dateInput = document.createElement('input');
                dateInput.type = 'date';
                dateInput.className = 'ml-2 border px-2 py-1 rounded text-sm';
                dateInput.addEventListener('change', () => {
                    // prefer date+time when both filled
                    if (timeInput && timeInput.value) {
                        chooseRadio.value = (dateInput.value || '') + ' ' + timeInput.value;
                        chooseRadio.checked = true;
                        confirmHelper.textContent = 'Confirming will remove this patient from the waiting queue and set their appointment to scheduled at ' + dateInput.value + ' ' + timeInput.value + '.';
                    }
                });
                const timeInput = document.createElement('input');
                timeInput.type = 'time';
                timeInput.className = 'ml-2 border px-2 py-1 rounded text-sm';
                timeInput.addEventListener('change', () => {
                    // When time chosen, mark radio and combine with chosen date (or default date will be used server-side)
                    chooseRadio.value = (dateInput.value || '') + ' ' + timeInput.value;
                    chooseRadio.checked = true;
                    confirmHelper.textContent = 'Confirming will remove this patient from the waiting queue and set their appointment to scheduled at ' + (dateInput.value ? (dateInput.value + ' ') : '') + timeInput.value + '.';
                });
                const chooseSpan = document.createElement('span');
                chooseSpan.className = 'text-gray-700';
                chooseSpan.textContent = 'Choose another date & time';
                chooseAnotherWrapper.appendChild(chooseRadio);
                chooseAnotherWrapper.appendChild(chooseSpan);
                chooseAnotherWrapper.appendChild(dateInput);
                chooseAnotherWrapper.appendChild(timeInput);
                list.appendChild(chooseAnotherWrapper);

                const confirmBtn = document.createElement('button');
                confirmBtn.className = 'px-4 py-2 rounded bg-purple-600 text-white';
                confirmBtn.textContent = 'Confirm reschedule';
                confirmBtn.addEventListener('click', async () => {
                    const radios = document.getElementsByName('reschedule_choice_' + appointmentId);
                    let chosen = null; Array.from(radios).forEach(r => { if (r.checked) chosen = r.value; });
                    if (!chosen) { alert('Please choose a time'); return; }
                    try {
                        // chosen may be "HH:MM" or "YYYY-MM-DD HH:MM" depending on the inputs.
                        let payloadChosen = {};
                        if (chosen.indexOf(' ') !== -1) {
                            const parts = chosen.split(' ');
                            payloadChosen.chosenDate = parts[0];
                            payloadChosen.chosenTime = parts[1];
                            payloadChosen.chosen = chosen; // full
                        } else {
                            payloadChosen.chosenTime = chosen;
                        }
                        const r = await fetch('/queue/reschedule', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json', 'X-Requested-With': 'XMLHttpRequest' },
                            body: JSON.stringify(Object.assign({ appointmentId, confirm: true }, payloadChosen))
                        });
                        const res = await r.json();
                        if (res.success) {
                            // Show patient/staff/admin messages if returned
                            if (res.patient_message) {
                                // enqueue branch notification for patient (persisted server-side) — client shows a friendly message
                                try { if (window.showMessageModal) window.showMessageModal(res.patient_message, 'Patient notification', 'info'); else alert(res.patient_message); } catch(e) {}
                            }
                            if (res.staff_message) {
                                try { console.log('Staff message:', res.staff_message); } catch(e){}
                            }
                            if (res.admin_message) {
                                try { console.log('Admin message:', res.admin_message); } catch(e){}
                            }

                            if (window.showMessageModal) window.showMessageModal('Reschedule successful ✅. Notifications queued.', 'Success', 'info');
                            else alert('Reschedule successful ✅. Notifications queued.');
                            if (window.popModal) window.popModal();
                            // Try to call in-page refresh hook, otherwise reload
                            if (typeof window.refreshQueue === 'function') { try { window.refreshQueue(); } catch(e){} }
                            else window.location.reload();
                        } else if (res.status === 409 || res.code === 'conflict') {
                            // Conflict handling: show an in-modal conflict pane offering Auto-adjust or Pick another
                            const conflictPane = document.createElement('div');
                            conflictPane.className = 'mt-4 p-4 border rounded bg-yellow-50';
                            const cm = document.createElement('div');
                            cm.className = 'text-sm text-yellow-800 mb-2';
                            cm.textContent = res.message || ('The slot at ' + prettyTime(chosen) + ' is already booked.');
                            conflictPane.appendChild(cm);

                            const btnWrap = document.createElement('div');
                            btnWrap.className = 'flex space-x-2 justify-end';

                            const autoBtn = document.createElement('button');
                            autoBtn.className = 'px-3 py-2 bg-yellow-600 text-white rounded';
                            autoBtn.textContent = 'Auto-adjust to ' + (prettyTime(res.adjusted_time) || 'next available');
                            autoBtn.addEventListener('click', async () => {
                                if (!res.adjusted_time) {
                                    if (window.showMessageModal) window.showMessageModal('No adjusted slot available', 'Error', 'error');
                                    else alert('No adjusted slot available');
                                    return;
                                }
                                // Submit using adjusted_time
                                try {
                                    const r2 = await fetch('/queue/reschedule', {
                                        method: 'POST',
                                        headers: { 'Content-Type': 'application/json', 'X-Requested-With': 'XMLHttpRequest' },
                                        body: JSON.stringify({ appointmentId, confirm: true, chosenTime: res.adjusted_time, autoAdjusted: true })
                                    });
                                    const res2 = await r2.json();
                                        if (res2.success) {
                                        // res2.newTime may be a server-side formatted string; prefer prettyTime when possible
                                        const displayNew = res2.newTimeFormatted ? res2.newTimeFormatted : prettyTime(res2.newTime) || res2.newTime;
                                        if (window.showMessageModal) window.showMessageModal('Appointment rescheduled to ' + displayNew, 'Success', 'info');
                                        else alert('Appointment rescheduled to ' + displayNew);
                                        if (window.popModal) window.popModal();
                                        if (typeof window.refreshQueue === 'function') { try { window.refreshQueue(); } catch(e){} }
                                        else window.location.reload();
                                    } else {
                                        if (window.showMessageModal) window.showMessageModal(res2.message || 'Failed to reschedule after auto-adjust', 'Error', 'error');
                                        else alert(res2.message || 'Failed to reschedule after auto-adjust');
                                    }
                                } catch (err) {
                                    console.error('Auto-adjust submit failed', err);
                                    if (window.showMessageModal) window.showMessageModal('Error during auto-adjust', 'Error', 'error');
                                    else alert('Error during auto-adjust');
                                }
                            });

                            const pickBtn = document.createElement('button');
                            pickBtn.className = 'px-3 py-2 bg-gray-100 text-gray-800 rounded';
                            pickBtn.textContent = 'Pick another time';
                            pickBtn.addEventListener('click', () => {
                                // Remove conflict pane so user can choose another option in the modal
                                if (conflictPane && conflictPane.parentNode) conflictPane.parentNode.removeChild(conflictPane);
                            });

                            btnWrap.appendChild(pickBtn);
                            btnWrap.appendChild(autoBtn);
                            conflictPane.appendChild(btnWrap);
                            // Insert conflict pane before the action row so it's visible
                            content.insertBefore(conflictPane, btnRow);
                            // Scroll into view to ensure staff notices it
                            conflictPane.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            return;
                        } else {
                            if (window.showMessageModal) window.showMessageModal(res.message || 'Failed to reschedule', 'Error', 'info');
                            else alert(res.message || 'Failed to reschedule');
                        }
                    } catch (err) {
                        console.error('Confirm reschedule error', err);
                        if (window.showMessageModal) window.showMessageModal('An error occurred while rescheduling', 'Error', 'error');
                        else alert('An error occurred while rescheduling');
                    }
                });

                btnRow.appendChild(cancelBtn);
                btnRow.appendChild(confirmBtn);
                content.appendChild(btnRow);

                if (window.pushModal) {
                    window.pushModal({ title: 'Suggested next slot', html: content, suppressActions: true });
                } else {
                    if (confirm('Reschedule appointment?')) {
                        await fetch('/queue/reschedule', { method: 'POST', headers: { 'Content-Type': 'application/json', 'X-Requested-With': 'XMLHttpRequest' }, body: JSON.stringify({ appointmentId, confirm: true }) });
                        window.location.reload();
                    }
                }

            } catch (err) {
                console.error('Reschedule error', err);
                if (window.showMessageModal) window.showMessageModal('An error occurred while fetching suggestions', 'Error', 'error');
                else alert('An error occurred while fetching suggestions');
            }
        };
    })();
</script>


</body>
</html>
<!-- DEBUG-VIEW ENDED 5 APPPATH\Views\templates\footer.php -->
 
<!-- DEBUG-VIEW ENDED 6 APPPATH\Views\auth\login.php -->

